<!-- Loader mientras carga -->
<div *ngIf="loading" class="arjs-loader">
  <div>Cargando AR...</div>
</div>

<!-- Mensajes de error -->
<div *ngIf="error" class="error-message">
  {{ error }}
</div>

<a-scene
  embedded
  arjs="trackingMethod: best; sourceType: webcam; sourceWidth:1280; sourceHeight:720; debugUIEnabled: false;"
>
  <ng-container *ngFor="let target of targets; trackBy: trackByTargetId">

    <!-- MARKER -->
    <a-marker
      *ngIf="target.type === 'marker'"
      [attr.preset]="target.markerpreset"
      [attr.url]="target.patternurl"
      emitevent="true"
    >
      <a-plane
        [attr.src]="target.contenturl"
        [attr.width]="getWidth(target)"
        [attr.height]="getHeight(target)"
        [attr.position]="target.position || '0 0 0.1'"
        [attr.rotation]="target.rotation || '0 0 0'"
        material="side:double; transparent:true; opacity:1"
      ></a-plane>
    </a-marker>

    <!-- NFT -->
    <a-nft
      *ngIf="target.type === 'nft'"
      type="nft"
      [attr.url]="target.nfturlbase"
      emitevent="true"
      smooth="true"
      smoothCount="15"
      smoothTolerance="0.02"
      smoothThreshold="10"
    >
      <a-plane
        [attr.src]="target.contenturl"
        [attr.width]="getWidth(target)"
        [attr.height]="getHeight(target)"
        [attr.position]="target.position || '0 0 0.1'"
        [attr.rotation]="target.rotation || '0 0 0'"
        material="side:double; transparent:true; opacity:1"
      ></a-plane>
    </a-nft>

    <!-- IMAGE -->
    <a-plane
      *ngIf="target.type === 'image'"
      [attr.src]="target.contenturl"
      [attr.width]="getWidth(target)"
      [attr.height]="getHeight(target)"
      [attr.position]="target.position || '0 1 -3'"
      [attr.rotation]="target.rotation || '0 0 0'"
      material="side:double; transparent:true; opacity:1"
    ></a-plane>

  </ng-container>

  <!-- CÃ¡mara principal -->
  <a-entity camera></a-entity>
</a-scene>
